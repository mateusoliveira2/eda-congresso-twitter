---
title: "REPLACE ME"
author: "Mateus de Lima olivera"
date: "02 de abril de 2019"
output:
    html_document:
    df_print: paged
theme: sandstone
---

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
source(here::here("code/lib.R"))
theme_set(theme_bw())
```


```{r read}
twitters = read_csv(here::here("data/atividade-por-perfil-20190322.csv"), 
                  col_types = "ccccccddddddddddddd")
glimpse(twitters)
```

### 1 - Quais partidos com mais parlamentares ativos em numero de twittes? 
*Feeling:* - PT, PSOl, PSL e PSDB.
```{r}
twitters %>%
  filter(!is.na(twitter)) %>%
  group_by(partido) %>%
  summarise(twittadas = sum(n_proprio)) %>%
  filter(twittadas > 3000)%>%
  ggplot(aes(x = twittadas, fill= partido, color= partido)) + 
  geom_histogram()


```

### 2 - Quais partidos tem mais engajamento por meio de seus parlamentares? 
*Feeling:* - PSL, PT.

```{r}
twitters %>%
  filter(!is.na(twitter)) %>%
  group_by(partido) %>%
  summarise(engajamento = sum(engaj_total)) %>%
  filter(engajamento > 100000) %>%
  ggplot(aes(x = partido, y = engajamento, fill = partido))+
   geom_bar(stat='identity') +
   coord_flip()
```

### 3 - Parlamentares de qual casa são mais presentes na rede social, percentualmente, com base no numero de twittes? 
*Feeling:* - Deputados

```{r}
percentual_twitter <- function(casa_parlamentar){
  num_total <- nrow(subset(twitters, casa == casa_parlamentar))
  num_parlamentares_ativos = nrow(subset(twitters, casa == casa_parlamentar & !is.na(twitter)))
  
  return ((num_parlamentares_ativos/num_total)*100)
}


twitters %>%
  filter(!is.na(twitter)) %>%
  group_by(casa) %>%
  summarise(percentual = percentual_twitter(casa)) %>%
  ggplot(aes(x=casa, y=percentual, fill=casa)) + 
  geom_bar(stat="identity")+
  labs(
        title="Percentual por casa", x="casa", y="percentual") +
  theme_bw() + scale_fill_grey(start = 0, end = .9)


```

### 4 - Qual a diferença entre numero total de deputados e o total de deputados engajados no twitter. 
*Feeling:* - cerca de 50%

### 5 - Quais estados tem deputados com mais envolvimento popular? 
*Feeling:* - São Paulo, Rio de Janeiro. 

### 6 - Quais parlamentares mais populares, em numero de seguidores? 
*Feeling:*  -Bolsonaro's, Lula e Dilma.                                      

```{r read}
atividade = read_projectdata()
```
